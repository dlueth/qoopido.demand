{"version":3,"sources":["cache/dispose.js"],"names":["localStorage","provide","functionIterate","PREFIX","SUFFIX","regexMatchState","RegExp","regexMatchProperties","getState","key","matches","state","getItem","match","Array","prototype","slice","call","getKey","id","filterStates","property","this","push","compareAccess","a","b","demand","clear","path","size","states","sort","length","shift"],"mappings":";CAAC,SAASA,GACT,aA2EAC,SAAU,4BAzEV,SAAoBC,GACnB,IAAIC,EAAuB,SAC1BC,EAAuB,QACvBC,EAAuB,IAAIC,OAAO,OAASH,EAAS,oBAAsBC,EAAS,QACnFG,EAAuB,kCAExB,SAASC,EAASC,GACjB,IACCC,EADGC,EAAQX,EAAaY,QAAQH,GAGjC,GAAGE,IAAUD,EAAUC,EAAME,MAAMN,IAClC,OAAOO,MAAMC,UAAUC,MAAMC,KAAKP,EAAS,GAI7C,SAASQ,EAAOC,GACf,MAAO,IAAMhB,EAAS,KAAOgB,EAAK,KAAOf,EAAS,IAgBnD,SAASgB,EAAaC,GACrB,IACCV,EADGE,EAAQQ,EAASR,MAAMR,GAGxBQ,KACFF,EAAWH,EAASU,EAAOL,EAAM,MAC3B,GAAKA,EAAM,GAEjBS,KAAKC,KAAKZ,IAIZ,SAASa,EAAcC,EAAGC,GACzB,OAAGD,EAAE,GAAKC,EAAE,IACH,EAGND,EAAE,GAAKC,EAAE,GACJ,EAGD,EAGR,OArCAxB,EAAgBF,EAAc,SAASqB,GACtC,IAAIR,EAAQQ,EAASR,MAAMR,GAGxBQ,IACML,EAASU,EAAOL,EAAM,KAEpB,IACTc,OAAOC,MAAMC,KAAKhB,EAAM,OA6BpB,SAAsBiB,GAC5B,IACCnB,EADGoB,KAOJ,IAJA7B,EAAgBF,EAAcoB,EAAcW,GAE5CA,EAAOC,KAAKR,GAENM,EAAO,GAAKC,EAAOE,QAExBH,IADAnB,EAASoB,EAAOG,SACD,GAEfP,OAAOC,MAAMC,KAAKlB,EAAM,OAvE5B,CA6EEX","file":"dispose.js","sourcesContent":["(function(localStorage) {\n\t'use strict';\n\n\tfunction definition(functionIterate) {\n\t\tvar PREFIX               = 'demand',\n\t\t\tSUFFIX               = 'state',\n\t\t\tregexMatchState      = new RegExp('^\\\\[' + PREFIX + '\\\\]\\\\[(.+?)\\\\]\\\\[' + SUFFIX + '\\\\]$'),\n\t\t\tregexMatchProperties = /^(.+?),(\\d+),(\\d*),(.+?),(\\d+)$/;\n\n\t\tfunction getState(key) {\n\t\t\tvar state = localStorage.getItem(key),\n\t\t\t\tmatches;\n\n\t\t\tif(state && (matches = state.match(regexMatchProperties))) {\n\t\t\t\treturn Array.prototype.slice.call(matches, 1);\n\t\t\t}\n\t\t}\n\n\t\tfunction getKey(id) {\n\t\t\treturn '[' + PREFIX + '][' + id + '][' + SUFFIX + ']';\n\t\t}\n\n\t\tfunctionIterate(localStorage, function(property) {\n\t\t\tvar match = property.match(regexMatchState),\n\t\t\t\tstate;\n\n\t\t\tif(match) {\n\t\t\t\tstate = getState(getKey(match[1]));\n\n\t\t\t\tif(!state[4]) {\n\t\t\t\t\tdemand.clear.path(match[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfunction filterStates(property) {\n\t\t\tvar match = property.match(regexMatchState),\n\t\t\t\tstate;\n\n\t\t\tif(match) {\n\t\t\t\tstate    = getState(getKey(match[1]));\n\t\t\t\tstate[5] = match[1];\n\n\t\t\t\tthis.push(state);\n\t\t\t}\n\t\t}\n\n\t\tfunction compareAccess(a, b) {\n\t\t\tif(a[4] < b[4]) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif(a[4] > b[4]) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn function cacheDispose(size) {\n\t\t\tvar states = [],\n\t\t\t\tstate;\n\n\t\t\tfunctionIterate(localStorage, filterStates, states);\n\n\t\t\tstates.sort(compareAccess);\n\n\t\t\twhile(size > 0 && states.length) {\n\t\t\t\tstate  = states.shift();\n\t\t\t\tsize  -= state[1];\n\n\t\t\t\tdemand.clear.path(state[5]);\n\t\t\t}\n\t\t};\n\t}\n\n\tprovide([ '/demand/function/iterate' ], definition);\n}(localStorage));"]}