{"version":3,"sources":["cache/dispose.js"],"names":["localStorage","provide","functionIterate","PREFIX","SUFFIX","regexMatchState","RegExp","regexMatchProperties","getState","key","matches","state","getItem","match","Array","prototype","slice","call","getKey","id","filterStates","property","this","push","compareAccess","a","b","demand","clear","path","size","states","sort","length","shift"],"mappings":";CAAA,SAAUA,GACN,aA6DAC,SAAS,4BA3DT,SAAoBC,GAChB,IAAIC,EAAS,SACTC,EAAS,QACTC,EAAkB,IAAIC,OAAO,OAASH,EAAS,oBAAsBC,EAAS,QAC9EG,EAAuB,kCAE3B,SAASC,EAASC,GACd,IACIC,EADAC,EAAQX,EAAaY,QAAQH,GAEjC,GAAIE,IAAUD,EAAUC,EAAME,MAAMN,IAChC,OAAOO,MAAMC,UAAUC,MAAMC,KAAKP,EAAS,GAInD,SAASQ,EAAOC,GACZ,MAAO,IAAMhB,EAAS,KAAOgB,EAAK,KAAOf,EAAS,IAatD,SAASgB,EAAaC,GAClB,IACIV,EADAE,EAAQQ,EAASR,MAAMR,GAEvBQ,KACAF,EAAQH,EAASU,EAAOL,EAAM,MACxB,GAAKA,EAAM,GACjBS,KAAKC,KAAKZ,IAIlB,SAASa,EAAcC,EAAGC,GACtB,OAAID,EAAE,GAAKC,EAAE,IACD,EAERD,EAAE,GAAKC,EAAE,GACF,EAEJ,EAEX,OA9BAxB,EAAgBF,EAAc,SAASqB,GACnC,IAAIR,EAAQQ,EAASR,MAAMR,GAEvBQ,IACQL,EAASU,EAAOL,EAAM,KACnB,IACPc,OAAOC,MAAMC,KAAKhB,EAAM,OAwB7B,SAAsBiB,GACzB,IACInB,EADAoB,KAIJ,IAFA7B,EAAgBF,EAAcoB,EAAcW,GAC5CA,EAAOC,KAAKR,GACLM,EAAO,GAAKC,EAAOE,QAEtBH,IADAnB,EAAQoB,EAAOG,SACD,GACdP,OAAOC,MAAMC,KAAKlB,EAAM,OA1DxC,CA+DGX","file":"dispose.js","sourcesContent":["(function(localStorage) {\n    \"use strict\";\n\n    function definition(functionIterate) {\n        var PREFIX = \"demand\",\n            SUFFIX = \"state\",\n            regexMatchState = new RegExp(\"^\\\\[\" + PREFIX + \"\\\\]\\\\[(.+?)\\\\]\\\\[\" + SUFFIX + \"\\\\]$\"),\n            regexMatchProperties = /^(.+?),(\\d+),(\\d*),(.+?),(\\d+)$/;\n\n        function getState(key) {\n            var state = localStorage.getItem(key),\n                matches;\n            if (state && (matches = state.match(regexMatchProperties))) {\n                return Array.prototype.slice.call(matches, 1)\n            }\n        }\n\n        function getKey(id) {\n            return \"[\" + PREFIX + \"][\" + id + \"][\" + SUFFIX + \"]\"\n        }\n        functionIterate(localStorage, function(property) {\n            var match = property.match(regexMatchState),\n                state;\n            if (match) {\n                state = getState(getKey(match[1]));\n                if (!state[4]) {\n                    demand.clear.path(match[1])\n                }\n            }\n        });\n\n        function filterStates(property) {\n            var match = property.match(regexMatchState),\n                state;\n            if (match) {\n                state = getState(getKey(match[1]));\n                state[5] = match[1];\n                this.push(state)\n            }\n        }\n\n        function compareAccess(a, b) {\n            if (a[4] < b[4]) {\n                return -1\n            }\n            if (a[4] > b[4]) {\n                return 1\n            }\n            return 0\n        }\n        return function cacheDispose(size) {\n            var states = [],\n                state;\n            functionIterate(localStorage, filterStates, states);\n            states.sort(compareAccess);\n            while (size > 0 && states.length) {\n                state = states.shift();\n                size -= state[1];\n                demand.clear.path(state[5])\n            }\n        }\n    }\n    provide([\"/demand/function/iterate\"], definition)\n})(localStorage);"]}