{"version":3,"sources":["handler/html.js"],"names":["provide","path","abstractHandler","isObject","merge","regexMatchType","container","document","createElement","settings","suffix","HandlerHtml","demand","on","options","prototype","validate","type","test","onPreRequest","dependency","pathname","url","slice","length","process","source","node","fragment","createDocumentFragment","innerHTML","firstElementChild","appendChild","parseHtml","extends"],"mappings":";CAAC,WACA,aAoDAA,QAAQ,CAAE,OAAQ,2BAA4B,6BAA8B,2BAlD5E,SAAoBC,EAAMC,EAAiBC,EAAUC,GACpD,IAAIC,EAAiB,cACpBC,EAAiBC,SAASC,cAAc,QACxCC,EAAiB,CAAEC,OAAQ,SAsB5B,SAASC,KAsBT,OA1CAC,OACEC,GAAG,iBAAmBZ,GAAM,SAASa,GAClCX,EAASW,IACXV,EAAMK,EAAUK,MAmBnBH,EAAYI,UAAY,CACvBC,SAAU,SAASC,GAClB,OAAOZ,EAAea,KAAKD,IAE5BE,aAAc,SAASC,EAAYV,GAClC,IAAIW,GAEJX,EAA4B,oBAAXA,EAA0BA,EAASD,EAASC,UAG5DW,EAAWD,EAAWE,IAAID,SAE1BD,EAAWE,IAAID,SAAWA,EAASE,OAAOb,EAAOc,UAAYd,EAASW,EAAWX,EAASW,IAG5FI,QAAS,SAASL,GACjBpB,SAAQ,WAAa,OA/BvB,SAAmB0B,GAClB,IACCC,EADGC,EAAWrB,SAASsB,yBAKxB,IAFAvB,EAAUwB,UAAYJ,EAEhBC,EAAOrB,EAAUyB,mBACtBH,EAASI,YAAYL,GAGtB,OAAOC,EAqBsBK,CAAUb,EAAWM,aAI5C,IAAKf,EAAYuB,QAAQhC,OAlDlC","file":"html.js","sourcesContent":["(function() {\n\t'use strict';\n\n\tfunction definition(path, abstractHandler, isObject, merge) {\n\t\tvar regexMatchType = /^text\\/html/,\n\t\t\tcontainer      = document.createElement('body'),\n\t\t\tsettings       = { suffix: '.html' };\n\n\t\tdemand\n\t\t\t.on('postConfigure:' + path, function(options) {\n\t\t\t\tif(isObject(options)) {\n\t\t\t\t\tmerge(settings, options);\n\t\t\t\t}\n\t\t\t});\n\n\t\tfunction parseHtml(source) {\n\t\t\tvar fragment = document.createDocumentFragment(),\n\t\t\t\tnode;\n\n\t\t\tcontainer.innerHTML = source;\n\n\t\t\twhile(node = container.firstElementChild) {\n\t\t\t\tfragment.appendChild(node);\n\t\t\t}\n\n\t\t\treturn fragment;\n\t\t}\n\n\t\tfunction HandlerHtml() {}\n\n\t\tHandlerHtml.prototype = {\n\t\t\tvalidate: function(type) {\n\t\t\t\treturn regexMatchType.test(type);\n\t\t\t},\n\t\t\tonPreRequest: function(dependency, suffix) {\n\t\t\t\tvar pathname;\n\n\t\t\t\tsuffix = (typeof suffix !== 'undefined') ? suffix : settings.suffix;\n\n\t\t\t\tif(suffix) {\n\t\t\t\t\tpathname = dependency.url.pathname;\n\n\t\t\t\t\tdependency.url.pathname = pathname.slice(-suffix.length) !== suffix ? pathname + suffix : pathname;\n\t\t\t\t}\n\t\t\t},\n\t\t\tprocess: function(dependency) {\n\t\t\t\tprovide(function() { return parseHtml(dependency.source); });\n\t\t\t}\n\t\t};\n\n\t\treturn new (HandlerHtml.extends(abstractHandler));\n\t}\n\n\tprovide([ 'path', '/demand/abstract/handler', '/demand/validator/isObject', '/demand/function/merge' ], definition);\n}());\n"]}